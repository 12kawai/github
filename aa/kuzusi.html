<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ブロック崩し</title>
  <style>

p {
            font-size: 2rem;
        }

        a:visited {
            color: #cae03a;
        }

        a:hover {
            color: #FFFFFF;
            background: #0000DD;
        }

        a:active {
            color: #FF0000;
        }

        h1 {
            color: rgb(247, 247, 14);
            font-size: 4rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        p {
            margin: 10px 0;
            font-size: 1.5rem;
        }

        a {
            color: #dae80f;
            text-decoration: none;
            color: #FF1493;
            font-weight: bold;
        }

        a:hover {
            color: #FF4500;
        }

        .container {
            display: grid;
            grid-template-columns: repeat(5, 80px);
            grid-template-rows: repeat(5, 80px);
            gap: 10px;
        }

        h1, .game-info, #startButton, #resetButton {
            text-align: center;
        }

        body {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
    background-size: cover;
    background-color: rgb(171, 201, 23);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            text-align: center;
            color: #7f08e1;
            
            font-weight: bold;
            /* background-color: #FFD700; */
            text-align: center;
            margin: 0;
            padding: 0;
    
}
    


    #canvas {
      border: 1px solid black;
    }
  </style>
</head>
<body>

<p style=" color: rgb(247, 247, 14); font-size: 24px; font-weight: bold; text-align: center; width: 100%;">
    ブロック崩し<br>    操作説明: 左移動 (A) 右移動 (D)
</p>

<canvas id="canvas" width="800" height="585"></canvas>
  

  <script>
    var canvas = document.getElementById("canvas");
    var ctx = canvas.getContext("2d");

    // ボールの初期位置と速度
    var ballX = canvas.width / 2;
    var ballY = canvas.height - 30;
    var ballDX = 2;
    var ballDY = -2;

    // パドルの初期位置とサイズ
    var paddleHeight = 10;
    var paddleWidth = 75;
    var paddleX = (canvas.width - paddleWidth) / 2;

    // ブロックの初期位置とサイズ
    var brickRowCount = 10; // 行数を7に増やす
    var brickColumnCount = 14; // 列数を10に増やす
    var brickWidth = 50; // ブロックの幅
    var brickHeight = 20; // ブロックの高さ
    var brickPadding = 4;
    var brickOffsetTop = 30;
    var brickOffsetLeft = 30;
    var bricks = [];

    // ブロックの色を定義（赤、青、黄色）
    var brickColors = ["red", "blue", "yellow"];

    for (var c = 0; c < brickColumnCount; c++) {
        bricks[c] = [];
        for (var r = 0; r < brickRowCount; r++) {
            var brickColor = brickColors[r % 3]; // 色を交互に設定
            bricks[c][r] = { x: 0, y: 0, status: 1, color: brickColor };
        }
    }

    // スコアとライフの初期値
    var score = 0;
    var lives = 3;

    // キーイベントの処理
    var rightPressed = false;
    var leftPressed = false;
    document.addEventListener("keydown", keyDownHandler, false);
    document.addEventListener("keyup", keyUpHandler, false);

    function keyDownHandler(e) {
        if (e.key == "d" || e.key == "D") {
            rightPressed = true;
        } else if (e.key == "a" || e.key == "A") {
            leftPressed = true;
        }
    }

    function keyUpHandler(e) {
        if (e.key == "d" || e.key == "D") {
            rightPressed = false;
        } else if (e.key == "a" || e.key == "A") {
            leftPressed = false;
        }
    }

    // 衝突判定
    function collisionDetection() {
        for (var c = 0; c < brickColumnCount; c++) {
            for (var r = 0; r < brickRowCount; r++) {
                var b = bricks[c][r];
                if (b.status == 1) {
                    if (
                        ballX > b.x &&
                        ballX < b.x + brickWidth &&
                        ballY > b.y &&
                        ballY < b.y + brickHeight
                    ) {
                        ballDY = -ballDY;
                        b.status = 0;
                        score++;
                        if (score == brickRowCount * brickColumnCount) {
                            alert("おめでとう！ブロックを破壊しました！");
                            document.location.reload();
                        }
                    }
                }
            }
        }
    }

    // 描画
    function drawBall() {
        ctx.beginPath();
        ctx.arc(ballX, ballY, 10, 0, Math.PI * 2);
        ctx.fillStyle = "#0095DD";
        ctx.fill();
        ctx.closePath();
    }

    function drawPaddle() {
        ctx.beginPath();
        ctx.rect(paddleX, canvas.height - paddleHeight, paddleWidth, paddleHeight);
        ctx.fillStyle = "#0095DD";
        ctx.fill();
        ctx.closePath();
    }

    function drawBricks() {
        for (var c = 0; c < brickColumnCount; c++) {
            for (var r = 0; r < brickRowCount; r++) {
                if (bricks[c][r].status == 1) {
                    var brickX = c * (brickWidth + brickPadding) + brickOffsetLeft;
                    var brickY = r * (brickHeight + brickPadding) + brickOffsetTop;
                    bricks[c][r].x = brickX;
                    bricks[c][r].y = brickY;
                    ctx.beginPath();
                    ctx.rect(brickX, brickY, brickWidth, brickHeight);
                    ctx.fillStyle = bricks[c][r].color; // ブロックの色を設定
                    ctx.fill();
                    ctx.closePath();
                }
            }
        }
    }

    function drawScore() {
        ctx.font = "16px Arial";
        ctx.fillStyle = "#0095DD";
        ctx.fillText("Score: " + score, 8, 20);
    }

    function drawLives() {
        ctx.font = "16px Arial";
        ctx.fillStyle = "#0095DD";
        ctx.fillText("Lives: " + lives, canvas.width - 65, 20);
    }

    // ゲームループ
    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        drawBricks();
        drawBall();
        drawPaddle();
        drawScore();
        drawLives();
        collisionDetection();

        // ボールの移動
        ballX += ballDX;
        ballY += ballDY;

        // ボールが壁に当たった場合の処理
        if (ballX + ballDX > canvas.width - 10 || ballX + ballDX < 10) {
            ballDX = -ballDX;
        }
        if (ballY + ballDY < 10) {
            ballDY = -ballDY;
        } else if (ballY + ballDY > canvas.height - 10) {
            if (ballX > paddleX && ballX < paddleX + paddleWidth) {
                ballDY = -ballDY;
            } else {
                lives--;
                if (!lives) {
                    alert("ゲームオーバー！");
                    document.location.reload();
                } else {
                    ballX = canvas.width / 2;
                    ballY = canvas.height - 30;
                    ballDX = 2;
                    ballDY = -2;
                    paddleX = (canvas.width - paddleWidth) / 2;
                }
            }
        }

        // パドルの移動
        if (rightPressed && paddleX < canvas.width - paddleWidth) {
            paddleX += 7;
        } else if (leftPressed && paddleX > 0) {
            paddleX -= 7;
        }

        if (!lives) {
            ctx.font = "30px Arial";
            ctx.fillStyle = "#0095DD";
            ctx.fillText("Game Over", canvas.width / 2 - 80, canvas.height / 2 - 20);
            ctx.font = "16px Arial";
            ctx.fillText("Press Space to restart", canvas.width / 2 - 90, canvas.height / 2 + 20);
            document.addEventListener("keydown", restartGame);
        }
        requestAnimationFrame(draw);
    }

    function restartGame(e) {
        if (e.key == "Space") {
            // Spaceを押してゲームを再スタート
            document.location.reload();
        }
    }

    function drawGameOver() {
        ctx.font = "30px Arial";
        ctx.fillStyle = "#0095DD";
        var gameOverText = "Game Over";
        var gameOverTextWidth = ctx.measureText(gameOverText).width;
        ctx.fillText(gameOverText, (canvas.width - gameOverTextWidth) / 2, canvas.height / 2 - 20);
        ctx.font = "16px Arial";
        var restartText = "Press Space to restart";
        var restartTextWidth = ctx.measureText(restartText).width;
        ctx.fillText(restartText, (canvas.width - restartTextWidth) / 2, canvas.height / 2 + 20);
    }  

    draw(); // ゲームを開始

  </script>
<a href="index.php">タイトルへ</a>

</body>

</html>
